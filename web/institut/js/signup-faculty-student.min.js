$(document).ready(function(){shj={};$.signUpGlobal={iVIEW_COURSE_PICKER:1,iVIEW_STUDENT_DETAIL:2,iVIEW_STUDENT_LEISTUNGEN:3,iVIEW_STUDENT_ANMELDUNGEN:4,iVIEW_STUDENT_STUDIENBILANZ:5,iVIEW_STUDENT_PRUEFUNGEN:6,iVIEW_STUDENT_ANTRAG:7,iVIEW_STUDENT_ANTRAG_TRANSKRIPT_1:8,iVIEW_STUDENT_TRANSKRIPTDRUCK:9,iTYP_ANTRAG_TRANSKRIPT_DE:1,iTYP_ANTRAG_TRANSKRIPT_EN:2,iTYP_ANTRAG_TRANSKRIPT_UNMODULAR:3,iTYP_ANTRAG_GYMPO_MISSING_CREDITS:4,sLIFECYCLE_REROUTE_TESTING_PREFIX:""};window.log=function(a,b){(new Image).src=
"log.jsp?sev="+encodeURIComponent(a)+"&msg="+encodeURIComponent(b)};window.onerror=function(a,b,c){log(1,"Fehler in Zeile "+c+" ("+b+"): "+a);return!0};$.ajaxSetup({type:"POST",data:{signup_expected_backend_version:"1-0-0-2"},timeout:2E4,contentType:"application/x-www-form-urlencoded;charset=utf8",dataType:"json",cache:!1,error:function(a,b,c){a=eval("("+a.responseText.substring(a.responseText.indexOf("{"))+")");1!=a.errorcode&&(11==a.errorcode?document.location="./index-studierende.jsp":alert("Sorry, ein unerwarteter Fehler ist aufgetreten. Der Server meldet: \n\n"+
a.error))}});window.explainMe=function(a){alert("Es ist ein: "+a);for(var b in a)alert(b+": "+a[b])};shj.signUp=function(){var a=function(a,b,c,f){0!==arguments.length&&(this._name=a,this.namespace=c.namespace,this.seminar_id_orig=this.seminar_id=b,this.lifecycle_base_url=f,"undefined"!==typeof c&&$.extend(this,c))};a.prototype.add=function(a,b){c(this,"add",a,b);return!0};a.prototype.update=function(a,b){c(this,"update",a,b);return!0};a.prototype.drop=function(a,b){c(this,"delete",a,b);return!0};
var b=function(a,b,k,f){if(0!==arguments.length){this.seminar_id=a;this._name=b;this.lifecycle_base_url=k.lifecycle_base_url;this.namespace=k.namespace;this.item_identifier=k.identifier;this.item_constructor=k.constructor_name;this.item_name=k._name;var e=this,h=[];"_offline"===this.lifecycle_base_url?"function"===typeof f&&f(e):c(e,"get",function(a){for(var b=0;b<a[e._name].length;b++)h[b]=new shj.signUp[e.namespace][e.item_constructor](e.seminar_id,a[e._name][b][e.item_name]),h[b].namespace=e.namespace;
e[e._name]=h;"function"===typeof f&&f(e);return e},function(){});return e}};b.prototype.drop=function(a,b,c){var f=this;a.drop(function(){for(var c=0;c<f[f._name].length;c++)if(f[f._name][c].equals(a)){f[f._name].splice(c,1);break}"function"===typeof b&&b()},c);return this};b.prototype.add=function(a,b,c,f){var e=this;(new shj.signUp[e.namespace][e.item_constructor](a,b)).add(function(f){$.extend(b,f[e.item_name]);e[e._name].push(new shj.signUp[e.namespace][e.item_constructor](a,b));"function"===
typeof c&&c(f)},f);return e};b.prototype.get=function(a){if(!this.item_identifier)return null;for(var b={},c=0;c<this[this._name].length;c++)if(this[this._name][c][this.item_identifier]==a){b=this[this._name][c];break}return b};b.prototype.getByName=function(a){for(var b={},c=0;c<this[this._name].length;c++)if(this[this._name][c].name==a){b=this[this._name][c];break}return b};getRequestValue=function(a){if(a=RegExp("[?&]"+encodeURIComponent(a)+"=([^&]*)").exec(location.search))return decodeURIComponent(a[1])};
getConstructorName=function(a){return(a=/function (.{1,})\(/.exec(a.constructor.toString()))&&1<a.length?a[1]:""};var c=function(a,b,c,f){var e={},h;for(h in a)"add"!==h&&("update"!==h&&"drop"!==h&&"get"!==h&&"namespace"!==h&&"function"!==typeof a[h]&&"object"!==typeof a[h])&&(e[h]=a[h]);e.signup_expected_backend_version="1-0-0-2";if("undefined"==a.lifecycle_base_url)throw Exception("Fehler im Lifecycle: kein URL definiert.");h=window.location.protocol+"//"+window.location.host+window.location.pathname;
h=0<=h.indexOf("Faculty")?h.substring(0,h.indexOf("Faculty/")+7):h.substring(0,h.indexOf("test"))+getRequestValue("shj_seminar")+"/Faculty";$.ajax({data:e,url:h+"/json/"+a.namespace+"/"+a.lifecycle_base_url+"/"+b+".jsp",type:"POST",success:function(a){"function"===typeof c&&c(a)},timeout:2E4,contentType:"application/x-www-form-urlencoded;charset=utf8",dataType:"json",cache:!1,error:function(a,b,c){"function"===typeof f&&!0===f($.parseJSON(a.responseText))||(a=eval("("+a.responseText.substring(a.responseText.indexOf("{"))+
")"),1==a.errorcode?alert("Sorry -- ein fehler ist aufgetreten. Falls das Programm nicht weiter normal funktioniert, melden Sie sich bitte neu an."):alert("Sorry -- ein fehler ist aufgetreten. Der Server meldet: \n"+a.error+"\n\nFalls das Programm nicht weiter normal funktioniert, melden Sie sich bitte neu an."))}});return!0};return{ShjCoreObject:a,ShjCoreCollection:b,lifecycle_act:c}}();shj.signUp.search=function(){return{findKurse:function(a,b,c){$.ajax({data:a,url:"json/kurs/get.jsp",success:function(a){var g=
[],k;for(k in a.kurse)g.push(a.kurse[k].kurs);0>=g.length?"function"===typeof c&&c():shj.signUp.toolbox.render(g,b)}});return this},findStudierende:function(a,b,c){$.ajax({data:a,url:"json/student/get.jsp",success:function(a){var g=[],k;for(k in a)g.push(a[k].student);$.isEmptyObject(b)||shj.signUp.toolbox.render(g,b);"function"===typeof c&&c(a)}});return this}}}();shj.signUp.toolbox=function(){return{isValidEmail:function(a){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a)},
isUnmodularInHeidelberg:function(a){a=parseInt(a);switch(a){case 8351:case 8361:case 8371:case 8352:case 8362:case 671:case 671:return!0;default:return!1}},getGermanDate:function(a){a=a.split("-");return a[2]+"."+a[1]+"."+a[0]},getDateFromGerman:function(a){a=a.split(".");return new Date(parseInt(a[2]),parseInt(a[1])-1,a[0])},getLastDayOfSemester:function(a){var b=new Date,c="#Err";"current"===a?(a=parseInt(b.getMonth())+1,c=2<a&&9>a?"31.8."+b.getFullYear():1==a?"28.2."+b.getFullYear():"28.2."+b.getFullYear()+
1):c=0==a.indexOf("ss")?"31.8."+a.substr(2,4):"28.2."+a.substr(7,4);return c},render:function(a,b){try{"undefined"!=typeof a.shj_rendering&&(b=a.shj_rendering)}catch(c){}if("TR"===$(b.HTML_template)[0].tagName)return this.shj_tabelizer(a,b);if("DL"===$(b.HTML_template)[0].tagName)return this.shj_tabelizer(a,b,!0);if("FORM"===$(b.HTML_template)[0].tagName)return this.mergeToForm(a,b);if("DIV"===$(b.HTML_template)[0].tagName)return this.mergeToDiv(a,b)},populateCbo:function(a,b){for(var c=0;c<a.length;c++)$("<option/>").val(a[c][b.identifyer]).text(a[c][b.text]).appendTo(b.cboIdentifyer)},
confirm:function(a,b,c,d,g){$(a).find(".shj_SignUp_Confirm_Header").text(b);$(a).find(".shj_SignUp_Confirm_Body").html(c);$(a).find(".cmdShj_SignUp_ConfirmAct_Cancel").off();$(a).find(".cmdShj_SignUp_ConfirmAct_Cancel").on("click",function(){g();$(a).modal("hide")});$(a).find(".cmdShj_SignUp_Confirm_Act").off();$(a).find(".cmdShj_SignUp_Confirm_Act").on("click",function(){d();$(a).modal("hide")});$(".modal").modal("hide");$(a).modal("show")},confirmDelete:function(a,b,c,d,g){$(a).find(".shj_SignUp_ConfirmDelete_Header").text(b);
$(a).find(".shj_SignUp_ConfirmDelete_Body").html(c);$("#cmdShj_SignUp_ConfirmDelete").off("click");$("#cmdShj_SignUp_ConfirmDelete_Cancel").off("click");$(".modal").modal("hide");$(a).modal("show");$("#cmdShj_SignUp_ConfirmDelete").on("click",function(){d();$(a).modal("hide")});$("#cmdShj_SignUp_ConfirmDelete_Cancel").on("click",function(){"function"===typeof g&&g();$(a).modal("hide")})},mergeToRow:function(a,b,c){$(a).data("shj_item",b);$.each(b,function(b,g){"function"!==typeof g&&$(a).find("."+
c+b).text(g)});return a},shj_tabelizer:function(a,b,c){!0===b.emptyFirst&&(!0!=c?$(b.HTML_table_container+" tbody").find("tr").remove():$(b.HTML_table_container+" dl").remove());var d=[],g=this;$.each(a,function(a,c){var e=$(b.HTML_template).clone();g.mergeToRow(e,c,b.HTML_template_class_prefix);d.push(e)});!1!==b.actOnDom&&(!0!=c?$(b.HTML_table_container+" tbody").append(d):($(b.HTML_table_container).append("<dl/>"),$(b.HTML_table_container+" dl").append(d)));return d},mergeToForm:function(a,b){var c=
b.HTML_template_class_prefix;$(b.HTML_template).removeData();!0==b.emptyFirst&&($(b.HTML_template+" input").val("").removeData(),$(b.HTML_template+" select").attr("selected",""));$(b.HTML_template).data("shj_item",a);$.each($(b.HTML_template+" input"),function(b,g){var k=a[$(g).attr("id").substring(c.length)];"undefined"!==typeof k&&$(g).val(k)});$.each($(b.HTML_template+" textarea"),function(b,g){var k=a[$(g).attr("id").substring(c.length)];"undefined"!==typeof k&&$(g).val(k)});$.each($(b.HTML_template+
" select"),function(b,g){var k=a[$(g).attr("id").substring(c.length)];"undefined"!==typeof k&&$(g).val(k);$("#"+$(g).attr("id")+" [value='"+k+"']").attr("selected","selected")});b.stripPrefixOffId&&$(b.HTML_template).find("*").each(function(a){if($(this).is("input")||$(this).is("select"))try{$(this).attr("id",$(this).attr("id").substring(c.length))}catch(b){}});return $(b.HTML_template)},mergeToDiv:function(a,b){var c=b.HTML_template_class_prefix;$(b.HTML_template).removeData();$(b.HTML_table_container).contents().filter(function(){return 3==
this.nodeType}).remove();$(b.HTML_template).data("shj_item",a);$.each(a,function(a,g){"function"!==typeof g&&(alert("Merging "+c+a+" with "+g),$(b.HTML_template).find("."+c+a).text(g))});return $(b.HTML_template)},renderDiv:function(a,b,c){$(a).data(b);$.each(b,function(b,g){$(a).find("."+c+b).html(g)});return a}}}();shj.signUp.kurstermine=function(){var a=function(b){var c={},k="So Mo Di Mi Do Fr Sa".split(" ");c.periode="block";c.abbrev="unklar";c.hint="--";11<b.length&&(c.periode="woche");18<b.length&&
(c.periode="halbwoche");38<b.length&&(c.periode="block");if("woche"==c.periode){for(var f=getNormalTime(b[0].start),e=getNormalTime(b[0].stop),h=getDateFromISO(b[0].datum).getDay(),l=0;l<b.length;l++){if(getNormalTime(b[l].start)!==f||getNormalTime(b[l].stop)!==e)c.periode="block",c.hint="Nicht w\u00f6chentlich, weil die "+l+".te Sitzung von "+b[l].start+"-"+b[l].stop+" l\u00e4uft, und nicht wie die erste von "+f+"-"+e;getDateFromISO(b[l].datum).getDay()!=h&&(console.log("INFO: Tag abweichend: "+
b[l].datum+" (Serienstart: "+b[0].datum+")"),c.periode="block",c.hint="Nicht w\u00f6chentlich, weil keine Woche zwischen dem "+(l-1)+".ten und dem "+l+".ten Termin liegt ("+b[l].datum+" f\u00e4llt aus der Rolle).")}"woche"==c.periode&&(c.abbrev=k[h]+" "+f.substring(0,5)+"-"+e.substring(0,5))}if("halbwoche"==c.periode){f=[];k=[];h=getDateFromISO(b[0].datum);tmpDtm=new Date(h.getTime()+6048E5);e=tmpDtm.getFullYear()+"-"+withLeadingZero(tmpDtm.getMonth()+1)+"-"+withLeadingZero(tmpDtm.getDate())==b[1].datum?
getDateFromISO(b[2].datum).getDay():getDateFromISO(b[1].datum).getDay();h=getDateFromISO(b[0].datum).getDay();h===e&&(c.periode="block",c.hint="Sah zun\u00e4chst aus wie halbw\u00f6chentlich, es gibt aber nur einen Tag anstatt zwei pro Woche");for(var l=0,m=b.length;l<m;l++)if(getDateFromISO(b[l].datum).getDay()===h)f.push(b[l]);else if(getDateFromISO(b[l].datum).getDay()===e)k.push(b[l]);else{c.periode="block";c.hint="Sah zun\u00e4chst aus wie halbw\u00f6chentlich, aber Termin Nr. "+l+" am "+b[l].datum+
" l\u00e4sst sich nicht einordnen.";break}"halbwoche"==c.periode&&(b=a(f),h={},"woche"!=b.periode?(c.periode="block",c.hint="Sah zun\u00e4chst aus wie halbw\u00f6chentlich, aber der erste Termin findet nicht w\u00f6chentlich statt, denn: >>"+b.hint+"<<."):(h=a(k),"woche"!=h.periode?(c.periode="block",c.hint="Sah zun\u00e4chst aus wie halbw\u00f6chentlich, aber der zweite Termin findet nicht w\u00f6chentlich statt, denn: >>"+h.hint+"<<."):c.abbrev=b.abbrev+", "+h.abbrev))}return c},b=function(a,g,
k){var f=[],e=c(a.day)+1;g.feiertage=g.feiertage||"1969-1-1";var h=getDateFromISO(g.semesterStart),l=getDateFromISO(g.semesterStop),m=0,m=e-h.getUTCDay();0>m&&(m+=7);e=new Date(h.getTime()+parseInt(864E5*m));h={};h.datum=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate();h.start=getNormalTime(a.start);h.stop=getNormalTime(a.stop);f.push(h);h=e;for(m=0;20>m;m++){var n={},e=new Date(h.getTime()+6048E5);if(e.getTime()>l.getTime())break;h=e;n.datum=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate();
n.start=getNormalTime(a.start);n.stop=getNormalTime(a.stop);0>g.feiertage.indexOf(n.datum)&&f.push(n)}2<arguments.length&&(l=b(k,g),f=f.concat(l),f.sort(function(a,b){return getDateFromISO(a.datum).getTime()-getDateFromISO(b.datum).getTime()}));return f},c=function(a){var b=-1;a=a.toLowerCase();0<=["mo","mon","montag","monday"].indexOf(a)&&(b=0);0<=["di","tue","dienstag","tuesday"].indexOf(a)&&(b=1);0<=["mi","wed","mittwoch","wednesday"].indexOf(a)&&(b=2);0<=["do","thu","donnerstag","thursday"].indexOf(a)&&
(b=3);0<=["fr","fri","freitag","friday"].indexOf(a)&&(b=4);0<=["sa","sam","samstag","saturday"].indexOf(a)&&(b=5);0<=["so","sun","sonntag","sunday"].indexOf(a)&&(b=6);return b};withLeadingZero=function(a){return 10>parseInt(a)?"0"+parseInt(a):a};getDateFromISO=function(a){a=a.split("-");return new Date(Date.UTC(a[0],parseInt(a[1])-1,parseInt(a[2])))};getNormalTime=function(a){return 5<a.length?a.substring(0,5):a};return{guessPattern:a,getTermineKomplett:b,getDayCode:c}}();shj.signUp.seminar=function(){var a=
function(a,b){0!==arguments.length&&(this.seminar_id_orig=a,this.lifecycle_base_url="information","undefined"!==typeof b&&$.extend(this,b),this.equals=function(a){return this.id===a.id},shj.signUp.ShjCoreObject.call(this,"Information",a,{namespace:"seminar"},"information"))};a.prototype=new shj.signUp.ShjCoreObject;a.prototype.kommentiere=function(a,b,c){this.sonderfkt="Kommentar";this.kommentar=a;this.add(b,c)};var b=function(a,b,c){this.seminar_id=a;this.lifecycle_base_url="informationen";"undefined"!==
typeof c&&(this.info_after=c);shj.signUp.ShjCoreCollection.call(this,a,"informationen",{lifecycle_base_url:"information",_name:"information",item_identifier:"id",identifier:"id",constructor_name:"Information",namespace:"seminar"},b)};b.prototype=new shj.signUp.ShjCoreCollection;var c=function(a,b){0!==arguments.length&&(this.seminar_id_orig=a,this.lifecycle_base_url="note","undefined"!==typeof b&&$.extend(this,b),this.equals=function(a){return this.id===a.id},shj.signUp.ShjCoreObject.call(this,"Note",
a,{namespace:"seminar"},"note"))};c.prototype=new shj.signUp.ShjCoreObject;var d=function(a,b){this.seminar_id=a;this.lifecycle_base_url="note";shj.signUp.ShjCoreCollection.call(this,a,"noten",{lifecycle_base_url:"note",_name:"note",item_identifier:"id",identifier:"id",constructor_name:"Note",namespace:"seminar"},b)};d.prototype=new shj.signUp.ShjCoreCollection;var g=function(a,b){0!==arguments.length&&(this.seminar_id_orig=a,this.lifecycle_base_url="dozent","undefined"!==typeof b&&$.extend(this,
b),this.equals=function(a){return this.id===a.id},shj.signUp.ShjCoreObject.call(this,"Dozent",a,{namespace:"seminar"},"dozent"))};g.prototype=new shj.signUp.ShjCoreObject;var k=function(a,b){this.seminar_id=a;this.lifecycle_base_url="dozent";shj.signUp.ShjCoreCollection.call(this,a,"dozenten",{lifecycle_base_url:"dozent",_name:"dozent",identifier:"id",constructor_name:"Dozent",namespace:"seminar"},b)};k.prototype=new shj.signUp.ShjCoreCollection;var f=function(a,b){0!==arguments.length&&(this.seminar_id_orig=
a,this.lifecycle_base_url="fach",this.hasModule=!1,"undefined"!=typeof b.module&&(this.hasModule=!0,this.module=new l(a,b.module)),"undefined"!==typeof b&&$.extend(this,b),this.equals=function(a){return this.id===a.id},shj.signUp.ShjCoreObject.call(this,"Fach",a,{namespace:"seminar"},"fach"))};f.prototype=new shj.signUp.ShjCoreObject;var e=function(a,b){this.seminar_id=a;this.lifecycle_base_url="fach";shj.signUp.ShjCoreCollection.call(this,a,"faecher",{lifecycle_base_url:"fach",_name:"fach",identifier:"id",
constructor_name:"Fach",namespace:"seminar"},b)};e.prototype=new shj.signUp.ShjCoreCollection;e.prototype.getLeistungen=function(){if("undefined"!==typeof this.leistungenArr)return this.leistungenArr;for(var a=[],b=";",c=[],d=0;d<this.faecher.length;d++)for(var e=0;e<this.faecher[d].module.length;e++)for(var f=0;f<this.faecher[d].module[e].modul.leistungen.length;f++)0>b.indexOf(";"+this.faecher[d].module[e].modul.leistungen[f].leistung.id+";")&&(b+=this.faecher[d].module[e].modul.leistungen[f].leistung.id+
";",c.push(this.faecher[d].module[e].modul.leistungen[f].leistung.name),a.push(this.faecher[d].module[e].modul.leistungen[f].leistung));a.sort(function(a,b){var c=a.name.toLowerCase(),d=b.name.toLowerCase();return c<d?-1:c>d?1:0});return this.leistungenArr=a};var h=function(a,b){if(0!==arguments.length){this.seminar_id_orig=a;this.lifecycle_base_url="seminar/fach/modul";for(var c=[],d=0;d<b.leistungen.length;d++)c[d]=new m(this.seminar_id,b.leistungen[d].leistung);this.leistungen=c;"undefined"!==
typeof b&&$.extend(this,b);this.equals=function(a){return this.id===a.id};shj.signUp.ShjCoreObject.call(this,"Modul",a,{namespace:"seminar"},"modul")}};h.prototype=new shj.signUp.ShjCoreObject;var l=function(a,b,c){this.seminar_id=a;this.lifecycle_base_url="_offline";shj.signUp.ShjCoreCollection.call(this,a,"module",{lifecycle_base_url:"_offline",_name:"modul",identifier:"id",constructor_name:"Modul",namespace:"seminar"},c);if("function"===typeof c)return c(this),this};l.prototype=new shj.signUp.ShjCoreCollection;
var m=function(a,b){0!==arguments.length&&(this.seminar_id_orig=a,this.modul_id=this.modul,this.lifecycle_base_url="leistung","undefined"!==typeof b&&$.extend(this,b),this.equals=function(a){return this.id===a.id},shj.signUp.ShjCoreObject.call(this,"Leistung",a,{namespace:"seminar"},"leistung"))};m.prototype=new shj.signUp.ShjCoreObject;var n=function(a,b){this.seminar_id=a;this.lifecycle_base_url="leistung";shj.signUp.ShjCoreCollection.call(this,this.seminar_id,"leistungen",{lifecycle_base_url:"leistung",
_name:"leistung",identifier:"id",constructor_name:"Leistung",namespace:"seminar"},b)};n.prototype=new shj.signUp.ShjCoreCollection;var p=function(a,b){0!==arguments.length&&(this.seminar_id_orig=a,this.lifecycle_base_url="kurstyp","undefined"!==typeof b&&$.extend(this,b),this.equals=function(a){return this.id===a.id},shj.signUp.ShjCoreObject.call(this,"Kurstyp",this.seminar_id,{namespace:"seminar"},"kurstyp"))};p.prototype=new shj.signUp.ShjCoreObject;var q=function(a,b){this.seminar_id=a;this.lifecycle_base_url=
"kurstyp";shj.signUp.ShjCoreCollection.call(this,this.seminar_id,"kurstypen",{lifecycle_base_url:"kurstyp",_name:"kurstyp",identifier:"id",constructor_name:"Kurstyp",namespace:"seminar"},b)};q.prototype=new shj.signUp.ShjCoreCollection;var r=function(a,b){0!==arguments.length&&(this.seminar_id_orig=a,this.lifecycle_base_url="kurs","undefined"!==typeof b&&$.extend(this,b),this.equals=function(a){return this.id===a.id},shj.signUp.ShjCoreObject.call(this,"Kurs",-1,{namespace:"seminar"},"kurs"))};r.prototype=
new shj.signUp.ShjCoreObject;var s=function(a,b){this.seminar_id=a;this.lifecycle_base_url="kurs";shj.signUp.ShjCoreCollection.call(this,-1,"kurse",{lifecycle_base_url:"kurs",_name:"kurs",identifier:"id",constructor_name:"Kurs",namespace:"seminar"},b)};s.prototype=new shj.signUp.ShjCoreCollection;return{Modul:h,Module:l,Dozent:g,Dozenten:k,Fach:f,Faecher:e,Information:a,Informationen:b,Leistung:m,Leistungen:n,Note:c,Noten:d,Kurstyp:p,Kurstypen:q,Kurs:r,Kurse:s}}();shj.signUp.student=function(){var a=
function(a,b){0!==arguments.length&&(this.matrikelnummer=b.matrikelnummer,this.lifecycle_base_url="anmeldung","undefined"!==typeof b&&($.extend(this,b),this.id_orig=b.id,this.count_orig=b.count,this.is_anmeldung=!0,this.aussteller=b.aussteller_vorname.trim(),"undefined"!=typeof b.aussteller_nachname&&(this.aussteller+=" "+b.aussteller_nachname.trim())),this.equals=function(a){return this.id===a.id&&this.count==a.count},shj.signUp.ShjCoreObject.call(this,"Anmeldung",-1,{namespace:"student",matrikelnummer:this.matrikelnummer},
"anmeldung"))};a.prototype=new shj.signUp.ShjCoreObject;var b=function(a,b){this.matrikelnummer=a;this.lifecycle_base_url="anmeldung";shj.signUp.ShjCoreCollection.call(this,-1,"anmeldungen",{lifecycle_base_url:"anmeldung",_name:"anmeldung",constructor_name:"Anmeldung",namespace:"student"},b)};b.prototype=new shj.signUp.ShjCoreCollection;var c=function(a,b){0!==arguments.length&&(this.lifecycle_base_url="leistung","undefined"!==typeof b&&($.extend(this,b),"undefined"===typeof this.modul_id&&(this.modul_id=
this.modul),this.id_orig=b.id,this.count_orig=b.count,this.is_anmeldung=!1,this.aussteller=b.aussteller_vorname+" "+b.aussteller_nachname),this.equals=function(a){return this.id===a.id&&this.count==a.count},shj.signUp.ShjCoreObject.call(this,"Leistung",-1,{namespace:"student",matrikelnummer:this.matrikelnummer},"leistung"))};c.prototype=new shj.signUp.ShjCoreObject;var d=function(a,b){this.matrikelnummer=a;this.lifecycle_base_url="leistung";shj.signUp.ShjCoreCollection.call(this,-1,"leistungen",{lifecycle_base_url:"leistung",
_name:"leistung",constructor_name:"Leistung",namespace:"student"},b)};d.prototype=new shj.signUp.ShjCoreCollection;var g=function(a,b){0!==arguments.length&&(this.matrikelnummer=b.matrikelnummer,this.equals=function(a){return this.id===a.id},this.lifecycle_base_url="pruefung","undefined"!==typeof b&&($.extend(this,b),this.id_orig=b.id,this.count_orig=b.count),shj.signUp.ShjCoreObject.call(this,"Pruefung",-1,{namespace:"student",matrikelnummer:this.matrikelnummer},"pruefung"))};g.prototype=new shj.signUp.ShjCoreObject;
var k=function(a,b){this.matrikelnummer=a;this.lifecycle_base_url="pruefung";shj.signUp.ShjCoreCollection.call(this,-1,"pruefungen",{lifecycle_base_url:"pruefung",_name:"pruefung",item_identifier:"id",constructor_name:"Pruefung",namespace:"student"},b)};k.prototype=new shj.signUp.ShjCoreCollection;var f=function(a,b){this.matrikelnummer=a;this.lifecycle_base_url="pruefung";this.konfigurierte_only=!0;k.call(this,a,b)};f.prototype.add=function(){alert("Sorry, nicht implementiert")};f.prototype.update=
function(){alert("Sorry, nicht implementiert")};f.prototype.drop=function(){alert("Sorry, nicht implementiert")};var e=function(a,b){0!==arguments.length&&($.extend(this,b),this.equals=function(a){return this.id===a.id},shj.signUp.ShjCoreObject.call(this,"Fachnote",a,{namespace:"student",matrikelnummer:b.matrikelnummer},"Fachnote"))};e.prototype=new shj.signUp.ShjCoreObject;var h=function(a,b){this.matrikelnummer=a;shj.signUp.ShjCoreCollection.call(this,-1,"fachnoten",{lifecycle_base_url:"fachnote",
_name:"fachnote",constructor_name:"Fachnote",namespace:"student"},b)};h.prototype=new shj.signUp.ShjCoreCollection;var l=function(a,b){0!==arguments.length&&(this.equals=function(a){return this.id===a.id},this.bemerkung_id||(this.bemerkung_id=b.id||b.bemerkung_id),shj.signUp.ShjCoreObject.call(this,"Bemerkung",-1,{namespace:"student",matrikelnummer:b.matrikelnummer,id:b.id,bemerkung:b.bemerkung,datum:b.datum,autor:b.autor},"bemerkung"))};l.prototype=new shj.signUp.ShjCoreObject;var m=function(a,b){this.matrikelnummer=
a;shj.signUp.ShjCoreCollection.call(this,-1,"bemerkungen",{lifecycle_base_url:"bemerkung",_name:"bemerkung",constructor_name:"Bemerkung",namespace:"student"},b)};m.prototype=new shj.signUp.ShjCoreCollection;var n=function(a,b){0!==arguments.length&&(this.equals=function(a){return this.verifikationscode===a.verifikationscode&&this.matrikelnummer===a.matrikelnummer},this.matrikelnummer=b.matrikelnummer,this.english=b.english?b.english:"false",$.extend(this,b),shj.signUp.ShjCoreObject.call(this,"Dokument",
-1,{namespace:"student",matrikelnummer:this.matrikelnummer},"transkript"))};n.prototype=new shj.signUp.ShjCoreObject;var p=function(a,b,c){this.matrikelnummer=a;shj.signUp.ShjCoreCollection.call(this,-1,"transkripte",{lifecycle_base_url:"transkript",_name:"transkript",constructor_name:"Dokument",namespace:"student"},b)};p.prototype=new shj.signUp.ShjCoreCollection;var q=function(a,b){0!==arguments.length&&(this.matrikelnummer=b.matrikelnummer,this.lifecycle_base_url="antrag",this.equals=function(a){return this.id===
a.id},$.extend(this,b),!this.antrag_id&&this.id&&(this.antrag_id=this.id),shj.signUp.ShjCoreObject.call(this,"Antrag",-1,{namespace:"student",matrikelnummer:this.matrikelnummer},"antrag"))};q.prototype=new shj.signUp.ShjCoreObject;var r=function(a,b){this.matrikelnummer=a;shj.signUp.ShjCoreCollection.call(this,-1,"antraege",{lifecycle_base_url:"antrag",_name:"antrag",constructor_name:"Antrag",namespace:"student"},b)};r.prototype=new shj.signUp.ShjCoreCollection;return{Bemerkung:l,Bemerkungen:m,Leistung:c,
Leistungen:d,Anmeldung:a,Anmeldungen:b,Pruefung:g,Pruefungen:k,KonfiguriertePruefungen:f,update:function(a,b,c,d){b.lifecycle_base_url="";b.namespace="student";b.matrikelnummer=a;shj.signUp.lifecycle_act(b,"update",c,d)},Antrag:q,Antraege:r,Dokument:n,Dokumente:p,Fachnoten:h,Fachnote:e}}()});$(document).ready(function(){window._renderLeistungenTabelle=function(a){if($(".tableSorter").length){if("undefined"===typeof $.signUpGlobal.tableSorterHeadLeistung||""===$.signUpGlobal.tableSorterHeadLeistung)$.signUpGlobal.tableSorterHeadLeistung=$("#divLeistungen").html();$("#divLeistungen").find("*").remove();$("#divLeistungen").html($.signUpGlobal.tableSorterHeadLeistung)}a.leistungen.shj_rendering={item:a.leistungen,emptyFirst:!0,HTML_template:"#template_leistung",HTML_table_container:"#divLeistungen",
HTML_template_class_prefix:"leistung_"};shj.signUp.toolbox.render(a.leistungen);$("#divLeistungen").find(".leistung_note").each(function(){"t"==$(this).parents("tr").data("shj_item").anerkannt&&$(this).append(' <span title="* = anerkannt" style="color:red; font-size:1.5em">*</span>')});$("#divLeistungen").find(".leistung_name").popover({delay:{show:800,hide:100},placement:"bottom",trigger:"hover",title:function(){return"<strong>"+$(this).parents("tr").data("shj_item").name},content:function(){return"<strong>"+
$(this).parents("tr").data("shj_item").kurstitel+"</strong><br />Aussteller: "+$(this).parents("tr").data("shj_item").aussteller_vorname+" "+$(this).parents("tr").data("shj_item").aussteller_nachname+"<br />Modul: "+getModulBezeichnung($(this).parents("tr").data("shj_item").modul)}});if($(".tableSorter :visible").length){var b=0;$("table.tableSorter tr").each(function(){$(this).find(".shjDataCol").attr("data-sortAs",b++)});$("table.tableSorter").tableSort()}};window.showLeistungen=function(a){if(null!=
student.leistungen&&"undefined"!=typeof student.leistungen&&student.matrikelnummer==student.leistungen.matrikelnummer)return 0===document.getElementById("tLeistungen").getElementsByTagName("tbody")[0].getElementsByTagName("tr").length&&(setView($.signUpGlobal.iVIEW_STUDENT_LEISTUNGEN),_renderLeistungenTabelle(student.leistungen,_renderLeistungenTabelle(student.leistungen))),setView($.signUpGlobal.iVIEW_STUDENT_LEISTUNGEN),!0;student.leistungen=new shj.signUp.student.Leistungen(student.matrikelnummer,
function(b){_renderLeistungenTabelle(b);"function"==typeof a&&a()});setView($.signUpGlobal.iVIEW_STUDENT_LEISTUNGEN)};window.getModulBezeichnung=function(a){for(var b="unbekannt",c=0;c<student.fach.module.length;c++)if(student.fach.module[c].modul.id==a){b=student.fach.module[c].modul.name;break}return b};window._renderAnmeldungenTabelle=function(a){shj.signUp.toolbox.render(a.anmeldungen,{item:a.anmeldungen,emptyFirst:!0,HTML_template:"#template_anmeldung",HTML_table_container:"#divAnmeldungen",
HTML_template_class_prefix:"anmeldung_"});var b=new Date;$("#divAnmeldungen").find(".anmeldungDelete a").each(function(){shj.signUp.toolbox.getDateFromGerman($(this).parents("tr").data("shj_item").fristende)<b&&$(this).addClass("disabled").attr("onclick","").attr("title","An- und Abmeldefrist abgelaufen")});$("#divAnmeldungen").find(".anmeldung_name").popover({delay:{show:800,hide:100},placement:"bottom",trigger:"hover",title:function(){return"<strong>"+$(this).parents("tr").data("shj_item").name},
content:function(){return"<strong>"+$(this).parents("tr").data("shj_item").kurstitel+"</strong><br />Aussteller: "+$(this).parents("tr").data("shj_item").aussteller_vorname+" "+$(this).parents("tr").data("shj_item").aussteller_nachname+"<br />Modul: "+getModulBezeichnung($(this).parents("tr").data("shj_item").modul)}})};window._renderPruefungenTabelle=function(a){a.pruefungen.shj_rendering={item:a.pruefungen,emptyFirst:!0,HTML_template:"#template_pruefung",HTML_table_container:"#divPruefungen",HTML_template_class_prefix:"pruefung_"};
shj.signUp.toolbox.render(a.pruefungen)};window.showPruefungen=function(a){if(null!=student.pruefungen&&"undefined"!=typeof student.pruefungen&&student.matrikelnummer==student.pruefungen.matrikelnummer)return setView($.signUpGlobal.iVIEW_STUDENT_PRUEFUNGEN),!0;student.pruefungen=new shj.signUp.student.Pruefungen(student.matrikelnummer,function(b){_renderPruefungenTabelle(b);"function"==typeof a&&a()});setView($.signUpGlobal.iVIEW_STUDENT_PRUEFUNGEN)};window.showAnmeldungen=function(a){if(null!=student.anmeldungen&&
"undefined"!=typeof student.anmeldungen&&student.matrikelnummer==student.anmeldungen.matrikelnummer)return setView($.signUpGlobal.iVIEW_STUDENT_ANMELDUNGEN),!0;student.anmeldungen=new shj.signUp.student.Anmeldungen(student.matrikelnummer,function(b){_renderAnmeldungenTabelle(b);"function"==typeof a&&a()});setView($.signUpGlobal.iVIEW_STUDENT_ANMELDUNGEN)};window.deleteAnmeldung=function(a){if(!a instanceof shj.signUp.student.Anmeldung)throw"Fehler im Programm. Es wurde keine Anmeldung zum L\u00f6schen \u00fcbergeben.";
shj.signUp.toolbox.confirmDelete("#modShj_SignUp_ConfirmDelete","Anmeldung l\u00f6schen?","Soll diese Anmeldung<br /><br /><b>"+a.name+"</b> ("+a.aussteller_nachname+")<br /><br />wirklich unwiderruflich gel\u00f6scht werden?",function(){student.anmeldungen.drop(a,function(){_renderAnmeldungenTabelle(student.anmeldungen)},function(){alert("Fehler -- sorry. Die Anmeldung konnte nicht gel\u00f6scht werden!")})})};window.modulContainsLeistung=function(a,b){for(var c=!1,d=0;d<student.fach.module.length;d++)for(var g=
0;g<student.fach.module[d].modul.leistungen.length;g++)if(student.fach.module[d].modul.id===a&&b===student.fach.module[d].modul.leistungen[g].leistung.id){c=!0;break}return c};window.addAnmeldung=function(a,b){if(null==student.anmeldungen||"undefined"==typeof student.anmeldungen)return showAnmeldungen(function(){addAnmeldung(a,b)}),!0;var c={};c.kurs_id=a.id;c.kurstyp_id=a.kurstyp_id;c.matrikelnummer=student.matrikelnummer;$.extend(c,a);c.kurstitel=a.titel;c.kurstitel_en=a.titel_en;c.id=a.leistung_id;
c.aussteller_vorname=a.lehrende.substr(0,a.lehrende.indexOf(" "));c.aussteller_nachname=a.lehrende.substring(a.lehrende.indexOf(" ")+1);c.name=a.leistung;c.ects=a.ects;c.fristende=a.fristende;var d=new Date;c.datum=d.getDate()+"."+(d.getMonth()+1)+"."+d.getFullYear();0<b&&(c.modul_id=b,c.modul=b);student.anmeldungen.add(student.matrikelnummer,c,function(a){_renderAnmeldungenTabelle(student.anmeldungen);$("#modKurssuche").modal("hide")})};window.getAbsolvierte=function(a,b,c,d){c=[];for(d=0;d<student.leistungen.leistungen.length;d++)student.leistungen.leistungen[d].id==
b.id&&student.leistungen.leistungen[d].modul==a.id&&c.push(student.leistungen.leistungen[d]);return c}});var search="nothing",student=[];
$(document).ready(function(){function a(b){console.log("[DEBUG]: .printDocx("+b+")");if(student.transkript)if("undefined"===typeof student.pruefungen)console.warn("[DEBUG]: ... muss erst pr\u00fcfungen laden."),student.pruefungen=new shj.signUp.student.Pruefungen(student.matrikelnummer,a);else{b=$.signUpGlobal.info.TEMPLATE;var c=function(a){if(!student.fachnote.fachnoten)return"#problem1";console.log("[DEBUG]: Getting Modulnote >"+a+"<, habe "+student.fachnote.fachnoten[0].module.length+" Module");
for(var b=0,c=student.fachnote.fachnoten[0].module.length;b<c;b++)if(student.fachnote.fachnoten[0].module[b].id==a)return student.fachnote.fachnoten[0].module[b].note.replace(".",",");return"#problem2"},d={module:[]},g=0,k=0;console.log("[DEBUG]: ... Rekodiere die >"+student.transkript.modul.length+"< Module in Array f\u00fcr Template.");for(var f=0;f<student.transkript.modul.length;f++){console.log("[DEBUG]: ... --- Modul "+student.transkript.modul[f].modul.name);var e={};e.min_lp=student.transkript.modul[f].modul.min_ects;
isNaN(e.min_lp)||(g+=parseFloat(e.min_lp));e.name=student.transkript.modul[f].modul.name;e.id=student.transkript.modul[f].modul.id;e.name_en=student.transkript.modul[f].modul.name_en;e.leer=!student.transkript.modul[f].modul.hatLeistung;e.leistungen=[];for(var h=0,l=0;l<student.transkript.modul[f].modul.leistungen.length;l++){console.log("[DEBUG]: ... --- ::: Leistung "+student.transkript.modul[f].modul.leistungen[l].name);var m={};m.lp=student.transkript.modul[f].modul.leistungen[l].ects;m.name=
student.transkript.modul[f].modul.leistungen[l].name;m.name_en=student.transkript.modul[f].modul.leistungen[l].name_en;m.kurstitel=student.transkript.modul[f].modul.leistungen[l].kurstitel&&2<student.transkript.modul[f].modul.leistungen[l].kurstitel.length?"\u00bb"+student.transkript.modul[f].modul.leistungen[l].kurstitel+"\u00ab":"";m.kurstitel_en=student.transkript.modul[f].modul.leistungen[l].kurstitel&&2<student.transkript.modul[f].modul.leistungen[l].kurstitel_en.length?"\u00bb"+student.transkript.modul[f].modul.leistungen[l].kurstitel_en+
"\u00ab":"";m.datum=student.transkript.modul[f].modul.leistungen[l].datum;"undefined"!==typeof student.transkript.modul[f].modul.leistungen[l].note&&(m.note_en=student.transkript.modul[f].modul.leistungen[l].note,m.note=m.note_en.replace(".",","));m.note&&0<=m.note.indexOf("Unbenotet (be")&&(0<m.note.indexOf("*")?(m.note="ub*",m.note_en="pass*"):(m.note="ub",m.note_en="pass"));m.note&&0<=m.note.indexOf("Anerkannt (be")&&(m.note="pass*");isNaN(m.lp)||(e.leistungen.push(m),h+=parseFloat(m.lp))}e.lp=
h;0==parseFloat(e.min_lp)||parseFloat(e.min_lp)>parseFloat(h)?0==parseFloat(e.min_lp)?e.modulnote="n/a":(e.modulnote_info="Vorl\u00e4ufige Modulnote ("+Math.round(100*(parseFloat(h)/parseInt(e.min_lp)))+"% abgeschlossen, "+(e.min_lp-h)+" LP fehlen noch)",e.modulnote_info_en="Preliminary Module Grade ("+Math.round(100*(parseFloat(h)/parseInt(e.min_lp)))+"% completed, "+(e.min_lp-h)+" credit points short)",e.modulnote=c(student.transkript.modul[f].modul.id),e.modulnote_en=e.modulnote.replace(",",".")):
parseFloat(e.min_lp)<parseFloat(h)?(e.modulnote_info="Problem: "+-1*(e.min_lp-h)+" LP zu viel verbucht, bitte Studienberatung kontaktieren.",e.modulnote_info_en="Problem: "+-1*(e.min_lp-h)+" credit points too many, please contact advisor.",e.modulnote="!",e.modulnote_en="!"):(e.modulnote_info="Modulnote",e.modulnote_info_en="Module Grade",console.log("[DEBUG]: ... --- ::: Hole Modulnote zu >"+student.transkript.modul[f].modul.id+"<"),console.log("[DEBUG]: ... --- ::: Hole Modulnote zu --\x3e"+c(student.transkript.modul[f].modul.id)+
"<"),e.modulnote=c(student.transkript.modul[f].modul.id),e.modulnote_en=e.modulnote.replace(",","."));"undefined"===typeof e.modulnote_info&&(e.modulnote_info="Modul unbenotet",e.modulnote_info_en="not graded",e.modulnote="--",e.modulnote_en="--");k+=e.lp;console.warn("[XX] LP des Moduls: "+e.lp+" Modulnote: "+e.modulnote);e.leer||d.module.push(e)}d.nachname=student.nachname;d.vorname=student.vorname;d.geburtsort=student.geburtsort;d.geburtstag=student.geburtstag;d.geburtstag_en="PROGRAM ME: "+student.geburtstag;
d.fachname=student.fachname;d.fachname_en="PROGRAM ME: "+student.fachname;student.fachnote.fachnoten?(d.fachnote=student.fachnote.fachnoten[0].notenwert,!0==student.fachnote.fachnoten[0].komplett?(d.fachnote_lang=student.fachnote.fachnoten[0].bezeichnung+" ("+student.fachnote.fachnoten[0].notenwert+")",d.fachnote_info="Fachnote",d.fachnote_lang_en=d.fachnote_lang.replace(",","."),d.fachnote_info_en="Overall Grade"):(d.fachnote_lang=student.fachnote.fachnoten[0].notenwert,d.fachnote_lang_en=d.fachnote_lang.replace(",",
"."),d.fachnote_info="Vorl\u00e4ufige Fachnote",d.fachnote_info_en="Preliminary Overall Grade")):(d.fachnote="#problem",d.fachnote_lang="keine Angabe m\u00f6glich",d.fachnote_lang_en="calculation not possible",d.fachnote_info="Vorl\u00e4ufige Fachnote",d.fachnote_info_en="Preliminary Overall Grade");d.anrede=student.anrede;d.anrede_en="Herr"==student.anrede?"Mr.":"Ms.";d.matrikelnummer=student.matrikelnummer;d.fachsemester=student.fachsemester.trim();d.fach_lp_gesamt=g;d.fach_lp_erreicht=k;d.datum=
"ww";d.module.sort(function(a,b){return a.id>b.id?1:-1});d.pruefungen=student.pruefungen.pruefungen;f=0;for(c=d.pruefungen.length;f<c;f++)d.pruefungen[f].datum=shj.signUp.toolbox.getGermanDate(d.pruefungen[f].datum),"0"==d.pruefungen[f].note.trim()&&(d.pruefungen[f].note="ub");(function(a,b){JSZipUtils.getBinaryContent(a,b)})("./templates/"+b+"?v="+Date.now(),function(a,b){a&&(console.log("[ERROR] .loadFile Template!"),console.log(a));doc=new Docxgen(b);doc.setData(d);doc.render();out=doc.getZip().generate({type:"blob"});
saveAs(out,"Transkript"+student.matrikelnummer+".docx")})}else b?(console.log("[DEBUG]: ... muss student.transkript einr\u00e4umen, rufe showTranscript mit printDocx als Callback."),showTranscript({fSuccess:a,iCallbackLoopCount:0}),console.log("[DEBUG]: ... exit nach Delegieren.")):(console.log("[ERR] signup-faculty-student.js.printDocx: nach Initialisierung immer noch kein Transkript."),alert('Fehler -- sorry. Kann das Transkript nicht ausgeben. Vielleicht hilft, erst "bearbeiten" zu klicken?'))}
$.signUpGlobal={iVIEW_SEARCH:0,iVIEW_SEARCH_RESULT:1,iVIEW_STUDENT_DETAIL:2,iVIEW_STUDENT_LEISTUNGEN:3,iVIEW_STUDENT_ANMELDUNGEN:4,iVIEW_STUDENT_TRANSKRIPT:5,iVIEW_STUDENT_PRUEFUNGEN:6,iVIEW_STUDENT_BEMERKUNGEN:7};$("body").on({ajaxStart:function(){window.g_signUp_deactivate_ajax_loader&&!0===window.g_signUp_deactivate_ajax_loader||$(this).addClass("loading").delay(1500).queue(function(a){$(this).hasClass("loading")&&$(this).removeClass("loading");a()})},ajaxStop:function(){$(this).removeClass("loading")}});
$.signUpGlobal.user_name=$("#logged-in-user-name").val();$.signUpGlobal.user_vorname=$("#logged-in-user-vorname").val();$.signUpGlobal.seminar_id=$("#logged-in-user-seminar").val();$.signUpGlobal.access_level=parseInt($("#logged-in-user-accesslevel").val());$.signUpGlobal.info={};$.signUpGlobal.info.seminar={};$("#modLeistungDetails").on("shown",function(){$("#leistung_name").focus()});$("#cmdShowFinalTranscripts").on("click",function(){$("#modFinalTranscripts").modal("show")});$("#modFinalTranscripts").on("show",
function(){showFinalTranscripts()});$("#cmdPrintDocxGen").on("click",function(){$.signUpGlobal.info.TEMPLATE=$("#cmdPrintDocxGen").attr("data-template");a(!0)});$("#cmdPrintDocxGen_en").on("click",function(){$.signUpGlobal.info.TEMPLATE=$("#cmdPrintDocxGen_en").attr("data-template");a(!0)});$.signUpGlobal.info.seminar.faecher=new shj.signUp.seminar.Faecher($.signUpGlobal.seminar_id,function(a){shj.signUp.toolbox.populateCbo(a.faecher,{identifyer:"id",text:"name",cboIdentifyer:"#cboFach"});$('#cboFach option[value="'+
student.fach_id+'"]').attr("selected",!0)});$.signUpGlobal.info.seminar.noten=new shj.signUp.seminar.Noten($.signUpGlobal.seminar_id,function(a){for(var c=[],d=0;d<a.noten.length;d++)c[d]={},c[d].id=a.noten[d].id,c[d].name=a.noten[d].wert+" -- "+a.noten[d].name;shj.signUp.toolbox.populateCbo(c,{identifyer:"id",text:"name",cboIdentifyer:"#leistung_noten_id"})});$.signUpGlobal.info.seminar.dozenten=new shj.signUp.seminar.Dozenten($.signUpGlobal.seminar_id,function(a){for(var c=[],d=0;d<a.dozenten.length;d++)c.push(a.dozenten[d].vorname+
" "+a.dozenten[d].name);$("#leistung_aussteller").typeahead({source:c,items:6})});$(".dropdown-toggle").dropdown();$("#cmdPruefungAdd").on("click",addPruefung);$("#studentLeistungListe").on("click",showLeistungen);$("#studentAnmeldungListe").on("click",showAnmeldungen);$("#cmdShowPruefungen").on("click",showPruefungen);$("#modBemerkungErfassen").on("shown",function(){$("#bemerkung_bemerkung").focus()});$("#txtSuche").focus();$("#fLeistungDetails input").on("blur",function(){setLeistungAktionen(leistung)});
$("#fLeistungDetails select").on("blur",function(){setLeistungAktionen(leistung)});$("#leistung_leistungstyp").on("change",function(){controlVisibilityHA()});$("form").submit(function(a){a.preventDefault()});$("#fKurssuche").submit(function(a){a.preventDefault();showKurssucheErgebnis()});$("#fFindStudents").submit(function(a){a.preventDefault();findStudents()});$("#cmdWechsel").on("click",function(a){a.preventDefault();updateFach()});$("#fPruefungAdd").submit(function(a){a.preventDefault()});$("#fRenewLogin").submit(function(a){a.preventDefault();
renewLoginCreateServerSession()});idleTimer=null;idleState=!1;idleWait=1500;$("#txtSuche").on("keydown",function(){clearTimeout(idleTimer);idleState=!1;idleTimer=setTimeout(function(){3<=$("#txtSuche").val().length&&search!=$("#txtSuche").val()&&(search=$("#txtSuche").val(),$("#fFindStudents").submit());idleState=!0},idleWait)});$("body").keydown(function(a){"text"!==a.target.type&&(39===a.which?$("#studentDetails").hasClass("active")?showLeistungen():$("#studentLeistungen").hasClass("active")?showAnmeldungen():
$("#studentAnmeldungen").hasClass("active")?showTranscript():$("#studentTranskript").hasClass("active")&&showPruefungen():37===a.which&&($("#studentLeistungen").hasClass("active")?showDetails("same"):$("#studentAnmeldungen").hasClass("active")?showLeistungen():$("#studentTranskript").hasClass("active")?showAnmeldungen():$("#studentPruefungen").hasClass("active")&&showTranscript()))})});
$.contextMenu.defaults({onShowMenu:function(a,b){var c=$(a.target).parents("tr").data("shj_item").id,d=parseInt($(a.target).parents("tr").data("shj_item").modul).toString();$("#transkriptContextMenu li").each(function(a){a=$(this).attr("id").substring(8);0<a.length&&"usatz"!=a&&!(d!=a&&modulContainsLeistung(a,c))&&$("#cctxmod-"+a,b).remove();0<d.indexOf("999999")&&$("#zusatz",b).remove()});return b}});function renewLoginAskPassword(){$(".modal").modal("hide");$("#modReLogin").modal("show")}
function renewLoginCreateServerSession(){var a={};a.user_name=$.signUpGlobal.user_name;a.user_pwd=$("#txtPwd").val();a.seminar_id=$.signUpGlobal.seminar_id;a.matrikelnummer=student.matrikelnummer;$.ajax({data:a,url:"json/renewLogin.jsp",success:function(a){"true"==a.success?$("#modReLogin").modal("hide"):window.location.href="logout.jsp"},error:function(a){window.location.href="logout.jsp"}})}
function showPruefungCalculations(a){$("#modPruefungNotenberechnung .modal-body").html(a);$("#modPruefungNotenberechnung").modal("show")}
function showPruefungOptions(){$("#missingCreditList").hide();$("#cmdPruefungAdd").text("Ausstellen");$("#lblPruefungAddWarning").hide();$("#cmdPruefungAdd").addClass("btn-success").removeClass("btn-danger").unbind().on("click",addPruefung);$("#cgPruefungAdd").removeClass("error");$("#flagIgnoreMissingCredits").val(!1);null==student.konfigurierte_pruefungen||"undefined"==typeof student.konfigurierte_pruefungen?student.konfigurierte_pruefungen=new shj.signUp.student.KonfiguriertePruefungen(student.matrikelnummer,
function(a){_renderKonfiguriertePruefungen(a.pruefungen);$("#modPruefungAddOptions").modal("show")}):(_renderKonfiguriertePruefungen(student.konfigurierte_pruefungen.pruefungen),$("#modPruefungAddOptions").modal("show"))}function _renderKonfiguriertePruefungen(a){$("#cboPruefungAdd").html("");$.each(a,function(a,c){$("<option/>").val(c.id).text(c.bezeichnung).appendTo("#cboPruefungAdd")})}
function addPruefung(a){if(null==student.pruefungen||"undefined"==typeof student.pruefungen)return showPruefungen(function(){addPruefung()}),!0;var b={};b.pruefung_id=$("#cboPruefungAdd").val();b.bezeichnung=$("#cboPruefungAdd :selected").text();b.matrikelnummer=student.matrikelnummer;!0==a?(""==$("#txtNote").val()&&($("#txtNote").focus(),alert("Da noch Leistungen fehlen, kann die Note nicht automatisch berechnet werden.\n\nBitte geben Sie eine Note ein!")),b.saveAsIs="true",b.note_manuell=$("#txtNote").val()):
b.saveAsIs="false";$("#cmdPruefungAdd").button("loading");student.pruefungen.add(student.matrikelnummer,b,function(a){_renderPruefungenTabelle(student.pruefungen);$("#cmdPruefungAdd").button("reset");$("#modPruefungAddOptions").modal("hide")},function(a){$("#cmdPruefungAdd").button("reset");if("undefined"==typeof a||"undefined"==typeof a.bereinigungs_info.fehlende_leistungen)return!1;$("#missingCreditList").show();$("#cmdPruefungAdd").text("Trotzdem speichern");$("#lblPruefungAddWarning").show();
$("#cmdPruefungAdd").removeClass("btn-success").addClass("btn-danger").unbind().on("click",function(){addPruefung(!0)});$("#cgPruefungAdd").addClass("error");$("#txtNote").val("anerkannt");shj.signUp.toolbox.render(a.bereinigungs_info.fehlende_leistungen,{item:a.bereinigungs_info.fehlende_leistungen,emptyFirst:!0,HTML_template:"#template_fehlendeLeistungen",HTML_table_container:"#missingCreditList",HTML_template_class_prefix:"fehlendeLeistung_"});return!0})}
function printPruefung(a){window.location="print/PruefungGeneric.rtf?lPruefungID="+a.id+"&lPruefungCount="+a.count+"&matrikelnummer="+student.matrikelnummer}
function deletePruefung(a){shj.signUp.toolbox.confirmDelete("#modShj_SignUp_ConfirmDelete","Pr\u00fcfung l\u00f6schen?","Soll diese Pr\u00fcfung<br /><br /><b>"+a.bezeichnung+"</b> ("+a.datum+")<br /><br />wirklich unwiderruflich gel\u00f6scht werden?",function(){student.pruefungen.drop(a,function(){_renderPruefungenTabelle(student.pruefungen);student.bemerkungen.add(student.matrikelnummer,{name:"bemerkung",bemerkung:"Pr\u00fcfung gel\u00f6scht ("+a.bezeichnung+" ("+a.datum+"), "+a.note,matrikelnummer:student.matrikelnummer},
function(){shj.signUp.toolbox.render(student.bemerkungen.bemerkungen)})})},function(){})}function showStudiengangwechsel(){$("#modStudiengangswechsel").modal("show");$("#cboFach").val(student.fach_id)}
function updateFach(){var a={};a.fach_id=$("#cboFach").val();a.fach=$("#cboFach :selected").text();var b=$(".template_studentDetails_fachname").text();shj.signUp.student.update(student.matrikelnummer,a,function(){student.bemerkungen.add(student.matrikelnummer,{name:"bemerkung",bemerkung:"Fach ge\u00e4ndert von >"+b+"< zu >"+a.fach+"<",matrikelnummer:student.matrikelnummer},function(a){shj.signUp.toolbox.render(student.bemerkungen.bemerkungen)});student.fach_id=a.fach_id;student.fach=$.signUpGlobal.info.seminar.faecher.get(a.fach_id);
student.fachname=a.fach;$(".template_studentDetails_fachname").text(student.fachname);$(".tpl_studentWell_fachname").text(student.fachname);student.leistungen=null;student.anmeldungen=null;student.transkript=null;student.transkriptbindings=null;$("#cmdWechsel").button("reset");$("#modStudiengangswechsel").modal("hide")},function(){alert("Sorry -- Fachwechsel ist fehlgeschlagen");$("#cmdWechsel").button("reset");$("#modStudiengangswechsel").modal("hide")})}
function addFinalTranscript(a,b){b?student.finalTranscripts.add($.signUpGlobal.seminar_id,{gpa_json:"true",permanent:"true",matrikelnummer:student.matrikelnummer},function(){student.finalTranscripts=null;showFinalTranscripts()}):a?student.finalTranscripts.add($.signUpGlobal.seminar_id,{englisch:"true",permanent:"true",matrikelnummer:student.matrikelnummer},function(){_renderFinalTranscripts()}):student.finalTranscripts.add($.signUpGlobal.seminar_id,{permanent:"true",matrikelnummer:student.matrikelnummer},
function(){_renderFinalTranscripts()})}function dropFinalTranscript(a){shj.signUp.toolbox.confirmDelete("#modShj_SignUp_ConfirmDelete","Abschlusstranskript l\u00f6schen?","Soll dieses Transkript<br /><br /><b>"+student.finalTranscripts.transkripte[a].dok_name+" ("+student.finalTranscripts.transkripte[a].datum+")<br /><br />wirklich unwiderruflich gel\u00f6scht werden?",function(){student.finalTranscripts.drop(student.finalTranscripts.transkripte[a],function(){_renderFinalTranscripts()})})}
function showFinalTranscripts(){if("undefined"===typeof student.finalTranscripts||null===student.finalTranscripts)student.finalTranscripts=new shj.signUp.student.Dokumente(student.matrikelnummer,function(a){_renderFinalTranscripts()},!0)}
function _renderFinalTranscripts(){if(student.finalTranscripts){$("#listePermanenteTranskripte").empty();for(var a=[],b=0;b<student.finalTranscripts.transkripte.length;b++)if("true"==student.finalTranscripts.transkripte[b].permanent)with({transkr:student.finalTranscripts.transkripte[b]})a.push('<tr><td>\n                    <a href="./dokument.rtf?matrikelnummer='+student.matrikelnummer+"&datum="+transkr.datum+"&verifikation="+transkr.verifikationscode+'">'+transkr.dok_name+"</a></td><td>"+transkr.datum+
'</td><td><i class="icon-trash" onclick="dropFinalTranscript('+b+')"></i>&nbsp;</td></tr>');$("#listePermanenteTranskripte").html('<table class="table">'+a.join("")+"</table>")}}
function changeModule(a,b){isNaN(b)?a.modul_id="null":a.modul_id=b;a.modul=b;a.update(function(){for(var b=0;b<student.leistungen.leistungen.length;b++)if(student.leistungen.leistungen[b].id===a.id&&student.leistungen.leistungen[b].count===a.count){student.leistungen.leistungen[b]=a;break}showTranscript();$("#divLeistungen").find("tr").remove()})}
function transcriptEditLP(a,b){a.ects=parseFloat(b);a.update(function(){for(var b=0;b<student.leistungen.leistungen.length;b++)if(student.leistungen.leistungen[b].id===a.id&&student.leistungen.leistungen[b].count===a.count){student.leistungen.leistungen[b]=a;break}showTranscript();$("#divLeistungen").find("tr").remove()})}
function transcriptEdit(a,b,c){!0!==c?a.kurstitel=b:a.kurstitel_en=b;a.update(function(){for(var b=0;b<student.leistungen.leistungen.length;b++)if(student.leistungen.leistungen[b].id===a.id&&student.leistungen.leistungen[b].count===a.count){student.leistungen.leistungen[b]=a;break}showTranscript();$("#divLeistungen").find("tr").remove()})}
function transcriptAddLeistung(a,b){showEmptyCreditForm();$("#leistung_name").val(a.name);$("#leistung_aussteller").val($.signUpGlobal.user_vorname+" "+$.signUpGlobal.user_name);$("#cboLeistung").blur();$("#cboAussteller").blur();setLeistungAktionen();$("#cboModul").val(b)}
function showTranscript(a,b,c){a||(a={fSuccess:null,iCallbackLoopCount:0});if(4<=a.iCallbackLoopCount)console.log("[ERR]: showTranscript: Callback Loop.");else if(console.log("showTranskript, Aufruf Nr. "+a.iCallbackLoopCount),"undefined"===typeof student.leistungen||null==student.leistungen)console.log("[DEBUG]: ... Leistungen m\u00fcssen noch geladen werden ..."),student.leistungen=new shj.signUp.student.Leistungen(student.matrikelnummer,function(){showTranscript({fSuccess:a.fSuccess,iCallbackLoopCount:a.iCallbackLoopCount+
1})}),console.log("[DEBUG]: ... exit nach Delegieren.\n\n");else if(console.log("[DEBUG]: ... Leistungen liegen vor."),student.transkript=[],student.transkript.modul=[],student.fachnote){b=[];console.log("[DEBUG]: ... Loop durch Module des Fachs:");for(c=0;c<student.fach.module.length;c++){console.log("[DEBUG]: ... --- Modul "+student.fach.module[c].modul.name);student.transkript.modul.push({modul:{name:student.fach.module[c].modul.name,name_en:student.fach.module[c].modul.name_en,id:student.fach.module[c].modul.id,
min_ects:student.fach.module[c].modul.min_ects,leistungen:[]}});console.log("[DEBUG]: ... --- ::: Loop durch Leistungen des Moduls:");for(var d=0;d<student.fach.module[c].modul.leistungen.length;d++){console.log("[DEBUG]: ... --- ::: --- Leistung Nr. "+d);b=getAbsolvierte(student.fach.module[c].modul,student.fach.module[c].modul.leistungen[d].leistung,c,d);for(var g=0;g<b.length;g++)student.transkript.modul[c].modul.hatLeistung=!0,student.transkript.modul[c].modul.leistungen.push(b[g]);0===b.length&&
student.transkript.modul[c].modul.leistungen.push(student.fach.module[c].modul.leistungen[d].leistung)}}"function"===typeof a.fSuccess?(console.log("[DEBUG]: ... student.transkript ist einger\u00e4umt, rufe callback auf"),a.fSuccess()):(console.log("[DEBUG]: ... student.transkript ist einger\u00e4umt, rendere Transkript online"),renderTranscript())}else console.log("[DEBUG]: ... initialisiere Fachnote.\n\n"),student.fachnote=new shj.signUp.student.Fachnoten(student.matrikelnummer,function(){renderFachnote();
showTranscript({fSuccess:a.fSuccess,iCallbackLoopCount:a.iCallbackLoopCount+1})})}
function renderFachnote(){"true"===student.fachnote.fachnoten[0].komplett?$("#studentFachnote").html("Fachnote: "+student.fachnote.fachnoten[0].notenwert+" ("+student.fachnote.fachnoten[0].bezeichnung+")<br />"+(student.fachnote.warnung?student.fachnote.warnung:"")):($("#studentFachnote").html("<p>Vorl\u00e4ufige Fachnote: "+student.fachnote.fachnoten[0].notenwert+'<br /><a href="#" title="">[mehr...]</a></p>'),$("#studentFachnote a").popover({delay:{show:200,hide:100},title:function(){return"Informationen zur Fachnote"},
content:function(){return student.fachnote.fachnoten[0].info},placement:"bottom",trigger:"hover"}))}
function renderTranscript(){var a=[],b=0,c=0,d="";$("#transkriptContextMenu").html("<ul></ul>");$("#tStudienbilanz tbody").find("tr").remove();$("#transkript").find("*").remove();for(var g=0;g<student.transkript.modul.length;g++){var k=$("#tStudienbilanz").clone(),b=0,c=student.transkript.modul[g].modul.min_ects,d=d+(",'cctxmod-"+student.transkript.modul[g].modul.id+"': function(t){changeModule($(t).data('shj_item'), "+student.transkript.modul[g].modul.id+");}");$("#transkriptContextMenu ul").append('<li id="cctxmod-'+
student.transkript.modul[g].modul.id+'">&rarr; '+student.transkript.modul[g].modul.name);for(var f=0;f<student.transkript.modul[g].modul.leistungen.length;f++){if("undefined"!=typeof student.transkript.modul[g].modul.leistungen[f].note){var e=$("#template_transkript_absolvierte").clone(),b=b+parseFloat(student.transkript.modul[g].modul.leistungen[f].ects);shj.signUp.toolbox.mergeToRow(e,student.transkript.modul[g].modul.leistungen[f],"template_transkript_absolvierte_")}else e=$("#template_transkript_offene").clone(),
shj.signUp.toolbox.mergeToRow(e,student.transkript.modul[g].modul.leistungen[f],"template_transkript_offene_");a.push(e)}k.attr("id","mod_"+student.transkript.modul[g].modul.id);k.find(".template_ModulSummary_modulname").text(student.transkript.modul[g].modul.name);0==parseFloat(c)||parseFloat(c)>parseFloat(b)?(sClass="badge badge-warning",sSummary=0==parseFloat(c)?"0 LP verlangt, SignUp kann nicht sehen, zu wie viel % das Modul abgeschlossen ist.":Math.round(100*(parseFloat(b)/parseInt(c)))+"% abgeschl. ("+
(c-b)+" LP fehlen noch)."):parseFloat(c)<parseFloat(b)?(sClass="badge badge-important",sSummary=-1*(c-b)+" LP zu viel."):(sSummary="OK",sClass="badge badge-success");k.find(".template_ModulSummary_computedInfo").text(sSummary).parents("table").find("th").addClass(sClass);k.append(a);$("#transkript").append(k);$("#transkript").append("<hr>");a=[]}$("#transkriptContextMenu ul").append('<li id="zusatz">&rarr; Zusatzleistung');d="{"+d.substring(1)+',zusatz: function(t){changeModule($(t).data("shj_item"), "zusatz");}}';
student.transkriptbindings=eval("("+d+")");$("#transkript tr.with_contextmenu").contextMenu("transkriptContextMenu",{itemStyle:{fontSize:"0.7em"},bindings:eval("("+d+")")});setView($.signUpGlobal.iVIEW_STUDENT_TRANSKRIPT)}function showKurssuche(a){fillSemesterCboForKurssuche();showKurssucheFormular(!0);$("#modKurssuche").modal("show");$("#bCommitment").val(a)}
function showKurssucheFormular(a){a?($("#Kurssuchformular").show(),$("#modKurssuche .modal-footer").show(),$("#Kurssuchergebnis").hide()):($("#Kurssuchformular").hide(),$("#modKurssuche .modal-footer").hide(),$("#Kurssuchergebnis").show())}
function showKurssucheErgebnis(){showKurssucheFormular(!1);$("#cmdSearch").button("loading");shj.signUp.search.findKurse($("#fKurssuche").serialize(),{item:"kurs",emptyFirst:!0,actOnDom:!0,stripPrefixOffId:!1,HTML_template:"#template_kurs",HTML_table_container:"#Kurssuchergebnis",HTML_template_class_prefix:"kurssuche_"},function(){alert("Sorry -- unter diesen Kriterien wurde kein Kurs gefunden");showKurssucheFormular(!0)});$("#cmdSearch").button("reset");return!1}
function coursePicked(a){if("true"==$("#bCommitment").val()){var b=-1,c=-1,d=[];$.each(student.fach.module,function(g,k){b=k.modul.id.toString();modulContainsLeistung(b,a.leistung_id.toString())&&(c=k.modul.id,d.push('<tr class="linked-tablerow" class="anmeldungModulID" modul_id="'+b+'"><td>'+k.modul.name+"</td></tr>"))});1<d.length?($("#tKurssuchergebnistabelle").html(""),$("#lblKurssuche_Modulwahl").text("Bitte w\u00e4hlen Sie ein Modul..."),$("#tKurssuchergebnistabelle").append(d.join()),$("#tKurssuchergebnistabelle tr").bind("click",
function(){addAnmeldung(a,$(this).attr("modul_id"))})):1===d.length?addAnmeldung(a,c):addAnmeldung(a,-1)}else showKursAsLeistungToAdd(a)}
function showKursAsLeistungToAdd(a){initSeminarLeistungen();$("#fLeistungDetails input").val("");$("#fLeistungDetails").removeData();$("#fLeistungDetails").data("kurs",a);$("#txtLeistungID").focus();var b=new Date;"current"===a.semester?$("#leistung_datum").val(b.getDate()+"."+(parseInt(b.getMonth())+1)+"."+b.getFullYear()):$("#leistung_datum").val(shj.signUp.toolbox.getLastDayOfSemester(a.semester));$("#modLeistungDetails h3").html("Neue Leistung ("+a.semester_indicator+")");$("#leistung_name").val(a.leistung);
$("#leistung_aussteller").val(a.lehrende);$("#leistung_kurstitel").val(a.titel);$("#leistung_kurstitel_en").val(a.titel_en);$("#leistung_ects").val(a.ects);$("#leistung_noten_id option[value='null']").remove();$("<option/>").val("null").text("--w\u00e4hlen--").appendTo("#leistung_noten_id");$("#leistung_noten_id option[value='null']").attr("selected","true");$("#divConfirmDelete").hide();$("#divCreditDetailOptions").show();$("#modKurssuche").modal("hide");$("#modLeistungDetails").modal("show")}
function hideLeistungPopover(){$("#leistungen").find("td:nth-child(1)").popover("hide");$("#anmeldungen").find("td:nth-child(1)").popover("hide")}
function showBemerkungen(){if(!(500>$.signUpGlobal.access_level)){if(null!=student.bemerkungen&&"undefined"!=typeof student.bemerkungen&&student.matrikelnummer==student.bemerkungen.matrikelnummer)return setView($.signUpGlobal.iVIEW_STUDENT_BEMERKUNGEN),!0;student.bemerkungen=new shj.signUp.student.Bemerkungen(student.matrikelnummer,function(a){a.bemerkungen.shj_rendering={item:a.bemerkungen,emptyFirst:!0,HTML_template:"#template_studentDetails_BemerkungListe",HTML_table_container:"#studentDetails_BemerkungListeContainer",
HTML_template_class_prefix:"template_studentDetails_Bemerkung"};shj.signUp.toolbox.render(a.bemerkungen)})}}
function showBemerkung(a){500>$.signUpGlobal.access_level||("undefined"==typeof a?($("#fBemerkungEdit").removeData(),$("#fBemerkungEdit textarea").val(""),$("#fBemerkungEdit").find(".shj_lifecycle_delete").hide(),$("#fBemerkungEdit").find(".shj_lifecycle_update").hide(),$("#fBemerkungEdit").find(".shj_lifecycle_add").show()):(shj.signUp.toolbox.render(a,{item:"whatever",emptyFirst:!0,actOnDom:!0,stripPrefixOffId:!1,HTML_template:"#fBemerkungEdit",HTML_template_class_prefix:"bemerkung_"}),$("#fBemerkungEdit").find(".shj_lifecycle_delete").show(),
$("#fBemerkungEdit").find(".shj_lifecycle_update").show(),$("#fBemerkungEdit").find(".shj_lifecycle_add").hide()),$("#modBemerkungErfassen").modal("show"))}function updateBemerkung(a){$("#cmdUpdateBemerkung").button("loading");a.bemerkung=$("#bemerkung_bemerkung").val();a.update(function(a){shj.signUp.toolbox.render(student.bemerkungen.bemerkungen)});$("#cmdUpdateBemerkung").button("reset");$("#modBemerkungErfassen").modal("hide")}
function addBemerkung(){500>$.signUpGlobal.access_level||($("#cmdAddBemerkung").button("loading"),student.bemerkungen.add(student.matrikelnummer,{name:"bemerkung",bemerkung:$("#bemerkung_bemerkung").val(),matrikelnummer:student.matrikelnummer},function(a){shj.signUp.toolbox.render(student.bemerkungen.bemerkungen);$("#modBemerkungErfassen").modal("hide")}),$("#cmdAddBemerkung").button("reset"))}
function deleteBemerkung(a){if(a instanceof shj.signUp.student.Bemerkung)shj.signUp.toolbox.confirmDelete("#modShj_SignUp_ConfirmDelete","Bemerkung l\u00f6schen?","Soll diese Bemerkung<br /><br /><b>"+a.bemerkung+"<br /><br />wirklich unwiderruflich gel\u00f6scht werden?",function(){student.bemerkungen.drop(a,function(){shj.signUp.toolbox.render(student.bemerkungen.bemerkungen)})});else throw Exception("Interner Fehler: das zum L\u00f6schen \u00fcbergebene Objekt war keine Bemerkung");}
function showLeistung(a){initSeminarLeistungen();$("#cboNote option[value='null']").remove();hideLeistungPopover();$("#fLeistungDetails input").unbind("change");$("#fLeistungDetails select").unbind("change");$("#fLeistungDetails").find("[id^=cg]").removeClass("warning").removeClass("error");shj.signUp.toolbox.render(a,{item:"leistung",emptyFirst:!0,actOnDom:!0,stripPrefixOffId:!1,HTML_template:"#fLeistungDetails",HTML_template_class_prefix:"leistung_"});""==a.leistungstyp&&(a.leistungstyp="--");controlVisibilityHA();
initModule(a.id,a.modul);$("#leistung_anerkannt").prop("checked","t"==a.anerkannt);$("#cmdDeleteCredit").show();$("#modLeistungDetails").modal("show");$("#fLeistungDetails input").bind("change",function(){setLeistungAktionen(a)});$("#fLeistungDetails select").bind("change",function(){setLeistungAktionen(a)});$("#leistung_leistungstyp").bind("change",function(){controlVisibilityHA()});$("#cmdUpdateCredit").addClass("disabled")}
function addLeistung(a){if(null==student.leistungen||"undefined"==typeof student.leistungen)return showLeistungen(function(){addLeistung()}),!0;$("#cmdUpdateCredit").button("loading");var b={};b.id=getLeistungID("#leistung_name");b.name=$("#leistung_name").val();b.kurstitel=$("#leistung_kurstitel").val();b.kurstitel_en=$("#leistung_kurstitel_en").val();b.noten_id=$("#leistung_noten_id").val();b.note=$("#leistung_noten_id option:selected").text();b.datum=$("#leistung_datum").val();b.ects=$("#leistung_ects").val();
b.leistungstyp=$("#leistung_leistungstyp").val();b.details=$("#leistung_details").val();b.bemerkung=$("#leistung_bemerkung").val();b.modul_id=$("#cboModul").val();b.modul=b.modul_id;b.aussteller_id=getDozentID($("#leistung_aussteller").val());b.aussteller_vorname=$("#leistung_aussteller").val();b.aussteller_nachname="";b.matrikelnummer=student.matrikelnummer;!0===$("#leistung_anerkannt").prop("checked")?b.anerkannt="t":b.anerkannt=null;"undefined"!=typeof $("#fLeistungDetails").data("kurs")&&(b.kurs_id=
$("#fLeistungDetails").data("kurs").id,b.kurstyp_id=$("#fLeistungDetails").data("kurs").kurstyp_id,"Current"!=$("#fLeistungDetails").data("kurs").semester_indicator&&(b.archiv=!0));student.leistungen.add(student.matrikelnummer,b,function(b){_renderLeistungenTabelle(student.leistungen);a&&printLeistung(b.leistung);$("#modLeistungDetails").modal("hide");$("#studentTranskript").hasClass("active")&&showTranscript()});$("#cmdUpdateCredit").button("reset")}
function deleteLeistung(a){if(a instanceof shj.signUp.student.Anmeldung)return deleteAnmeldung(a),!0;shj.signUp.toolbox.confirmDelete("#modShj_SignUp_ConfirmDelete","Leistung l\u00f6schen?","Soll diese Leistung<br /><br /><b>"+a.name+"</b> ("+a.aussteller_nachname+")<br /><br />wirklich unwiderruflich gel\u00f6scht werden?",function(){student.leistungen.drop(a,function(){_renderLeistungenTabelle(student.leistungen);student.bemerkungen.add(student.matrikelnummer,{name:"bemerkung",bemerkung:"Leistung gel\u00f6scht ("+
a.name+" ("+a.id+"), "+a.aussteller+", "+a.kurstitel+", Note: "+a.note+" vom "+a.datum,matrikelnummer:student.matrikelnummer});$("#studentTranskript").hasClass("active")&&showTranscript()})},function(){})}
function updateLeistung(a,b){if("undefined"==typeof a)return addLeistung(b),!0;a.id=getLeistungID("#leistung_name");a.name=$("#leistung_name").val();a.kurstitel=$("#leistung_kurstitel").val();a.kurstitel_en=$("#leistung_kurstitel_en").val();a.noten_id=$("#leistung_noten_id").val();a.notenbezeichnung=$("#leistung_noten_id").text();a.note=$("#leistung_noten_id :selected").text();a.datum=$("#leistung_datum").val();a.ects=$("#leistung_ects").val();a.leistungstyp=$("#leistung_leistungstyp").val();a.details=
$("#leistung_details").val();a.bemerkung=$("#leistung_bemerkung").val();a.modul_id=$("#cboModul").val();a.modul=$("#cboModul").val();a.aussteller_id=getDozentID($("#leistung_aussteller").val());a.count_orig=a.count;!0===$("#leistung_anerkannt").prop("checked")?a.anerkannt="t":a.anerkannt=null;a.update(function(c){$("#modLeistungDetails").modal("hide");a instanceof shj.signUp.student.Anmeldung&&(null!=student.leistungen&&"undefined"!=typeof student.leistungen?student.leistungen.leistungen.push(a):
showLeistungen(),student.anmeldungen.drop(a,function(){_renderAnmeldungenTabelle(student.anmeldungen)}));student.transkript=null;setView($.signUpGlobal.iVIEW_STUDENT_LEISTUNGEN);null==student.leistungen?showLeistungen():_renderLeistungenTabelle(student.leistungen);b&&printLeistung(a)},function(){alert("Update der Leistung fehlgeschlagen -- keine weiteren Informationen verf\u00fcgbar")})}
function showAnmeldung(a){$("#cboNote option[value='null']").remove();hideLeistungPopover();$("#fLeistungDetails input").unbind("change");$("#fLeistungDetails select").unbind("change");$("#fLeistungDetails").find("[id^=cg]").removeClass("warning").removeClass("error");shj.signUp.toolbox.render(a,{item:"anmeldung",emptyFirst:!0,actOnDom:!0,stripPrefixOffId:!1,HTML_template:"#fLeistungDetails",HTML_template_class_prefix:"leistung_"});initModule(a.id,a.modul);$("<option/>").val("null").text("--w\u00e4hlen--").appendTo("#leistung_noten_id");
$("#leistung_noten_id option[value='null']").attr("selected","true");$("#modLeistungDetails").modal("show");$("#fLeistungDetails input").bind("change",function(){setLeistungAktionen(a)});$("#fLeistungDetails select").bind("change",function(){setLeistungAktionen(a)});$("#leistung_leistungstyp").bind("change",function(){controlVisibilityHA()});$("#cmdUpdateCredit").addClass("disabled")}
function showEmptyCreditForm(){initSeminarLeistungen();$("#fLeistungDetails").removeData();$("#fLeistungDetails input").val("");var a=new Date;$("#leistung_datum").val(a.getDate()+"."+(parseInt(a.getMonth())+1)+"."+a.getFullYear());$("#modLeistungDetails h3").html("Neue Leistung");$("#cboNote option[value='null']").remove();$("<option/>").val("null").text("--w\u00e4hlen--").appendTo("#cboNote");$("#cboNote option[value='null']").attr("selected","true");$("#cmdDeleteCredit").hide();$("#divCreditDetailOptions").show();
$("#leistung_aussteller").val($("#logged-in-user-vorname").val()+" "+$("#logged-in-user-name").val());$("#leistung_aussteller").blur();$("#modLeistungDetails").modal("show")}function printLeistung(a){window.location="print/Credit2Rtf.rtf?leistung="+a.id+"&leistung_count="+a.count}
function getLeistungID(){initSeminarLeistungen();for(var a=-1,b=$("#leistung_name").val(),c=0;c<$.signUpGlobal.info.seminar.leistungen.length;c++)if($.signUpGlobal.info.seminar.leistungen[c].name===b){a=$.signUpGlobal.info.seminar.leistungen[c].id;break}initModule(a,$("#cboModul").val());initCreditPts(a);return a}
function getDozentID(){for(var a=-1,b=$("#leistung_aussteller").val(),c=0;c<$.signUpGlobal.info.seminar.dozenten.dozenten.length;c++)if($.signUpGlobal.info.seminar.dozenten.dozenten[c].vorname+" "+$.signUpGlobal.info.seminar.dozenten.dozenten[c].name==b){a=$.signUpGlobal.info.seminar.dozenten.dozenten[c].id;break}return a}
function setLeistungAktionenNewCredit(){0>=$("#cboNote").val()||"null"==$("#cboNote").val()?$("#cgNote").addClass("error"):$("#cgNote").removeClass("error");var a=getLeistungID();0>a?$("#cgLeistung").addClass("error"):($("#cgLeistung").removeClass("error"),initModule(a,$("#cboModul").val()));0>getDozentID()?$("#cgAussteller").addClass("error"):$("#cgAussteller").removeClass("error");0==$("#fLeistungDetails .error").length?$("#cmdUpdateCredit").removeClass("disabled"):$("#cmdUpdateCredit").addClass("disabled")}
function setLeistungAktionen(a){null===a||"undefined"===typeof a?setLeistungAktionenNewCredit():($("#cboNote").val()!=a.noten_id||$("#leistung_datum").val()!=a.datum||$("#leistung_ects").val()!=a.ects?$("#cgNote").addClass("warning"):$("#cgNote").removeClass("warning"),0>=$("#cboNote").val()||"null"==$("#cboNote").val()?$("#cgNote").addClass("error"):$("#cgNote").removeClass("error"),$("#leistung_name").val()!=a.name?0>getLeistungID()?$("#cgLeistung").addClass("error"):($("#cgLeistung").removeClass("error"),
$("#cgLeistung").addClass("warning")):($("#cgLeistung").removeClass("warning"),$("#cgLeistung").removeClass("error")),$("#leistung_kurstitel").val()!=a.kurstitel?$("#cgKurs").addClass("warning"):$("#cgKurs").removeClass("warning"),$("#cboModul").val()!=a.modul?$("#cgModul").addClass("warning"):$("#cgModul").removeClass("warning"),$("#leistung_aussteller").val()!=a.aussteller?0>getDozentID()?$("#cgAussteller").addClass("error"):$("#cgAussteller").addClass("warning").removeClass("error"):$("#cgAussteller").removeClass("warning").removeClass("error"),
$("#cboLeistungstyp").val()!=a.leistungstyp||$("#leistung_details").val()!=a.details?$("#cgLeistungstyp").addClass("warning"):$("#cgLeistungstyp").removeClass("warning"),$("#leistung_bemerkung").val()!=a.bemerkung?$("#cgBemerkung").addClass("warning"):$("#cgBemerkung").removeClass("warning"),0<$("#fLeistungDetails .warning").length&&0==$("#fLeistungDetails .error").length?$("#cmdUpdateCredit").removeClass("disabled"):$("#cmdUpdateCredit").addClass("disabled"))}
function findStudents(a){student=null;clearSingleStudentDisplay();$(".shj-information").fadeOut();"undefined"!==typeof g_signUp_Informationen_Polling_Interval&&clearInterval(g_signUp_Informationen_Polling_Interval);search=$("#txtSuche").val();var b={};b.txtSuchen=$("#txtSuche").val();b.chkEhemalige=$("#chkEhemalige").prop("checked");shj.signUp.search.findStudierende(b,{item:"student",emptyFirst:!0,replace_rows:!0,HTML_template:"#template_studierende",HTML_table_container:"#liste",HTML_template_class_prefix:"student_"},
function(b){if(0===b.length){if(!0!==$("#chkEhemalige").prop("checked"))return $("#chkEhemalige").prop("checked","true").change(),null;alert("Leider ist unter '"+search+"' nichts zu finden.")}else 1===b.length&&showDetails(b[0].student.matrikelnummer,b[0].student,a)});$("#results").fadeIn(function(){$("#results").find(".student_nachname, .student_vorname").popover({delay:{show:800,hide:100},placement:"bottom",trigger:"hover",title:function(){return $(this).parents("tr").data("shj_item").anrede+" "+
$(this).parents("tr").data("shj_item").vorname+" <strong>"+$(this).parents("tr").data("shj_item").nachname+"</strong>"},content:function(){return $(this).parents("tr").data("shj_item").strasse+"<br />"+$(this).parents("tr").data("shj_item").plz+" "+$(this).parents("tr").data("shj_item").ort+'<br /><i class="icon-calendar"></i> '+$(this).parents("tr").data("shj_item").telefon+'<br /><i class="icon-envelope"></i> '+$(this).parents("tr").data("shj_item").email+"<br />--<br />"+$(this).parents("tr").data("shj_item").fach+
"<br />"+$(this).parents("tr").data("shj_item").fachsemester+". Semester"}})});$("#liste").show()}
function showDetails(a,b,c){function d(a){var b={setStxGymPO:!0};$("#details").find("#chkStudentStx").attr("checked")?($("#showAnmeldungStxDelete").show(),a&&(6>(new Date).getMonth()?$("#cboDelGymPOAnm_Month").val(9):($("#cboDelGymPOAnm_Month").val(3),$("#cboDelGymPOAnm_Year").val((new Date).getFullYear()+1))),b.chkStudentStx=!0,b.txtStxDelete=$("#cboDelGymPOAnm_Year").val()+"-"+$("#cboDelGymPOAnm_Month option:selected").val()+"-30"):$("#showAnmeldungStxDelete").hide();$.ajax({data:b,url:"json/student/update.jsp",
success:function(a){"true"==a.success?("checked"==a.state?$("#details").find("#chkStudentStx").attr("checked",!0):$("#details").find("#chkStudentStx").attr("checked",!1),$(".template_studentDetails_stx").addClass("label-success").delay(500).queue(function(a){$(".template_studentDetails_stx").removeClass("label-success");a()})):alert("Fehler :-(")},error:function(a){alert("Fehler :-(")}})}if("same"==a)setView($.signUpGlobal.iVIEW_STUDENT_DETAIL);else{leistung=null;$("#txtSuche").blur();student=b;student.leistungen=
null;student.anmeldungen=null;student.bemerkungen=null;try{student.transkript.modul=null,student.transkript=null}catch(g){}student.fach=null;student.fach=$.signUpGlobal.info.seminar.faecher.get(student.fach_id);null!==student.fach&&(student.fachname=student.fach.name);$("#studentInfo").hide();var k=$("#template_subStudentHeadlines").clone();shj.signUp.toolbox.renderDiv(k,student,"tpl_studentWell_");k.find("#template_studentPicture").attr("id","studentPhoto");k.find("#template_picplace").attr("id",
"picplace");k.find("#tpl_studentFachnote").attr("id","studentFachnote");$("#studentInfo").empty();$("#studentInfo").append(k);"Altbestand"==b.info&&$("#studentInfo").find(".altbestand").show().addClass("badge badge-important");$.ajax({url:"../../studentPhoto/"+student.pid+".jpg",type:"HEAD",success:function(){$("#studentPhoto").attr("src",function(){return"../../studentPhoto/"+student.pid+".jpg"});$("#picplace").attr("href",function(){return"../../studentPhoto/"+student.pid+".jpg"});$("#studentInfo").show()},
error:function(){$("#studentInfo").show();"Herr"==student.anrede&&$("#studentPhoto").attr("src","img/acspike_male_user_icon.png")}});b=$("#template_studentDetails").clone();b.find("#template_studentDetails_BemerkungListeContainer").attr("id","studentDetails_BemerkungListeContainer");b.find("#tpl_chkStudentStx").attr("id","chkStudentStx");b.find("#tpl_showAnmeldungStxDelete").attr("id","showAnmeldungStxDelete");b.find("#tpl_cboDelGymPOAnm_Year").attr("id","cboDelGymPOAnm_Year");b.find("#tpl_cboDelGymPOAnm_Month").attr("id",
"cboDelGymPOAnm_Month");shj.signUp.toolbox.renderDiv(b,student,"template_studentDetails_");$("#details").empty();$("#details").append(b);$("#details").find(".template_studentDetails_email").attr("href",function(){return"mailto:"+$("#details").find(".template_studentDetails_email").text()});$("#details").find(".template_studentDetails_homepage").attr("href",$("#details").find(".template_studentDetails_homepage").text());b=(new Date).getFullYear();$("#cboDelGymPOAnm_Year").find("option").remove().end().append('<option value="'+
b+'">'+b+'</option><option value="'+(b+1)+'">'+(b+1)+'</option><option value="'+(b+2)+'">'+(b+2)+"</option>");3<student.anmeldung_gympo.length?($("#details").find("#chkStudentStx").attr("checked",!0),$("#showAnmeldungStxDelete").show(),b=student.anmeldung_gympo.split("-"),$("#cboDelGymPOAnm_Year").val(b[0]),$("#cboDelGymPOAnm_Month").val(b[1])):($("#showAnmeldungStxDelete").fadeOut(),$("#details").find("#chkStudentStx").attr("checked",!1));$("#details").find("#chkStudentStx").off();$("#details").find("#chkStudentStx").on("click",
function(){d(!0)});$("#cboDelGymPOAnm_Month").on("change",d);$("#cboDelGymPOAnm_Year").on("change",d);$.signUpGlobal.matrikelnummer=a;500<=$.signUpGlobal.access_level&&(showBemerkungen(),$("a.zuv_heidelberg_ext").attr("href","http://adb.zuv.uni-heidelberg.de:8888/sach/INFO_FDB$.startup?MODUL=STUD&M1=2&M2=10&M3=0&PRO=&MODUS=SUCHERGEBNISS&TEXT="+a));setView($.signUpGlobal.iVIEW_STUDENT_DETAIL);"function"===typeof c&&c();return!0}}
function login(){window.open("util/delegate-login.jsp?matrikelnummer="+$.signUpGlobal.matrikelnummer,"_blank")}
function setView(a){$(".signUp_Student_Register").removeClass("active");$("#studentPruefungen").removeClass("active");$("#studentTranskript").removeClass("active");$("#studentLeistungen").removeClass("active");$("#studentAnmeldungen").removeClass("active");$(".signUp_viewToggle").hide();switch(a){case $.signUpGlobal.iVIEW_STUDENT_DETAIL:leistung=null;$("#singleStudent").fadeIn();$(".shj-information").fadeOut();"undefined"!==typeof g_signUp_Informationen_Polling_Interval&&clearInterval(g_signUp_Informationen_Polling_Interval);
$("#studentDetails").addClass("active");$("#details").show();break;case $.signUpGlobal.iVIEW_STUDENT_LEISTUNGEN:leistung=null;$("#singleStudent").fadeIn();$(".shj-information").fadeOut();"undefined"!==typeof g_signUp_Informationen_Polling_Interval&&clearInterval(g_signUp_Informationen_Polling_Interval);$("#divLeistungen").fadeIn();$("#studentLeistungen").addClass("active");$("#divLeistungen tr").length||_renderLeistungenTabelle(student.leistungen);break;case $.signUpGlobal.iVIEW_STUDENT_ANMELDUNGEN:leistung=
null;$("#singleStudent").fadeIn();$(".shj-information").fadeOut();"undefined"!==typeof g_signUp_Informationen_Polling_Interval&&clearInterval(g_signUp_Informationen_Polling_Interval);$("#studentAnmeldungen").addClass("active");$("#divAnmeldungen").fadeIn();break;case $.signUpGlobal.iVIEW_STUDENT_TRANSKRIPT:$(".shj-information").fadeOut();"undefined"!==typeof g_signUp_Informationen_Polling_Interval&&clearInterval(g_signUp_Informationen_Polling_Interval);$("#singleStudent").fadeIn();$("#studentTranskript").addClass("active");
$("#transkript").fadeIn();break;case $.signUpGlobal.iVIEW_STUDENT_PRUEFUNGEN:$(".shj-information").fadeOut(),"undefined"!==typeof g_signUp_Informationen_Polling_Interval&&clearInterval(g_signUp_Informationen_Polling_Interval),$("#singleStudent").fadeIn(),$("#divPruefungen").fadeIn(),$("#studentPruefungen").addClass("active")}}
function fillSemesterCboForKurssuche(){if(1>=$("#cboKurssucheSemester").length){var a=new Date,b=a.getFullYear();a.getMonth();for(a=2007;a<=b;a++)$("<option/>").val("ss"+a).text("Sommersemester "+a).appendTo("#cboKurssucheSemester"),$("<option/>").val("ws"+a+"/"+(a+1)).text("Wintersemester "+a+"/"+(a+1)).appendTo("#cboKurssucheSemester")}}
function initSeminarLeistungen(){if("undefined"===typeof $.signUpGlobal.info.seminar.leistungen){$.signUpGlobal.info.seminar.leistungen=$.signUpGlobal.info.seminar.faecher.getLeistungen();for(var a=[],b=0;b<$.signUpGlobal.info.seminar.leistungen.length;b++)a.push($.signUpGlobal.info.seminar.leistungen[b].name);$("#leistung_name").typeahead({source:a,items:14})}}
function initModule(a,b){$("#cboModul").empty();for(var c=0;c<student.fach.module.length;c++)for(var d=0;d<student.fach.module[c].modul.leistungen.length;d++)a===student.fach.module[c].modul.leistungen[d].leistung.id&&$("<option/>").val(student.fach.module[c].modul.id).text(student.fach.module[c].modul.name).appendTo("#cboModul");$("<option/>").val("null").text("Zusatzmodul").appendTo("#cboModul");0==b||"null"==b?$('#cboModul option[value="null"]').attr("selected","true"):$('#cboModul option[value="'+
b+'"]').attr("selected","true")}function initCreditPts(a){initSeminarLeistungen();for(var b=0;b<$.signUpGlobal.info.seminar.leistungen.length;b++)if($.signUpGlobal.info.seminar.leistungen[b].id===a){(""==$("#leistung_ects").val()||0>=$("#leistung_ects").val())&&$("#leistung_ects").val($.signUpGlobal.info.seminar.leistungen[b].cp);break}}function controlVisibilityHA(){"HA"==$("#leistung_leistungstyp").val()?$("#leistung_details").show():$("#leistung_details").hide()}
function clearSingleStudentDisplay(){$("divLeistungen tbody").find("tr").remove();$("divAnmeldungen tbody").find("tr").remove();$("divPruefungen tbody").find("tr").remove();$("#results").hide();$("#singleStudent").hide();$("#cgShowInactive").hide();$("#studentInfo").html("");$("#details").html("");$("#studentInfo").hide();leistung=null}
function showEditMode(a){if(!(0<a.find("input").length)){var b=a.text();a.html('<input class="span5" type="text" value="" onchange="transcriptEdit($(this).parents(&quot;tr&quot;).data(&quot;shj_item&quot;), $(this).val())"></input>').removeClass("editable");a.find("input").val(b).focus()}}
function showEditMode_en(a){if(!(0<a.find("input").length)){var b=a.text();a.html('<input class="span5" type="text" value="" onchange="transcriptEdit($(this).parents(&quot;tr&quot;).data(&quot;shj_item&quot;), $(this).val(), true)"></input>').removeClass("editable");a.find("input").val(b).focus()}}
function showEditModeLP(a){if(!(0<a.find("input").length)){var b=a.text();a.html('<input class="span1" type="text" value="" onchange="transcriptEditLP($(this).parents(&quot;tr&quot;).data(&quot;shj_item&quot;), $(this).val())"></input>').removeClass("editable");a.find("input").val(b).focus()}};
